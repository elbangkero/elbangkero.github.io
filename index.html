<script src="https://call.flyfonetalk.com/templates/assets/components/jquery/dist/jquery.js"></script>
<script type="text/javascript"
  src="https://call.flyfonetalk.com/templates/js/plugins/webcall.api.js?1740638749"></script>
<script type="text/javascript"
  src="https://call.flyfonetalk.com/templates/js/plugins/webcall.notify.js?1740638749"></script>
<script type="text/javascript"
  src="https://call.flyfonetalk.com/templates/js/voice/sipjs/sip-0.7.7.min.js?1740638749"></script>
<script type="text/javascript"
  src="https://call.flyfonetalk.com/templates/js/voice/modernizr.custom.js?1740638749"></script>
<script type="text/javascript" src="https://call.flyfonetalk.com/templates/js/voice/classie.js?1740638749"></script>
<script type="text/javascript"
  src="https://call.flyfonetalk.com/templates/js/voice/notificationFx.js?1740638749"></script>

<script type="text/javascript" src="webphone_notifFxCall.js?1740638749"></script>
<link rel="stylesheet" href="https://call.flyfonetalk.com/templates/css/ace/bootstrap.css?1740638749" />
<link rel="stylesheet" href="https://call.flyfonetalk.com/templates/css/font-awesome.min.css?1740638749" />
<link rel="stylesheet" href="https://call.flyfonetalk.com/templates/css/ace/ace.css?1740638749" />
<link rel="stylesheet" href="https://call.flyfonetalk.com/templates/css/frame.css?1740638749" />
<link rel="stylesheet" href="https://call.flyfonetalk.com/templates/css/keypad.css?1740638749" />
<link rel="stylesheet"
  href="https://call.flyfonetalk.com/templates/css/voice/notificationFx/ns-default.css?1740638749" />
<link rel="stylesheet"
  href="https://call.flyfonetalk.com/templates/css/voice/notificationFx/ns-style-growl.css?1740638749" />
<link rel="stylesheet"
  href="https://call.flyfonetalk.com/templates/css/voice/notificationFx/ns-style-attached.css?1740638749" />
<link rel="stylesheet" href="https://call.flyfonetalk.com/templates/assets/components/chosen/chosen.css" />
<script src="https://call.flyfonetalk.com/templates/assets/components/chosen/chosen.jquery.min.js"></script>
<audio id="chat_sound" controls class="dpn" style="display: none">
  <source src="https://call.flyfonetalk.com/templates/assets/sounds/notify.mp3" type="audio/mp3" />
</audio>
<audio id="sound_income_call" controls loop class="dpn" style="display: none">
  <source src="https://call.flyfonetalk.com/templates/assets/sounds/ringing.wav" type="audio/wav" />
</audio>

<audio id="sound_dtmf" style="display: none">
  <source src="https://call.flyfonetalk.com/templates/assets/sounds/dtmf_star.ogg" type="audio/ogg" />
</audio>
<script type="text/javascript">
  var callCode = 'd5a24856959a183b69834f99fad86e5d';
  window.addEventListener("message", receiveMessageFromParent, false);
  function receiveMessageFromParent(event) {
    var message = event.data;
    if (typeof message == "undefined") {
      return;
    }

    var data = JSON.parse(message);
    if (data === undefined) {
      return;
    }

    var number = data['phone'].trim();
    var crm_ticket_id = data['crm_ticket_id'].trim();
    if (number === "") {
      return;
    }
    if (/^[0-9]*$/gm.test(number) == false) {
      return;
    }

    jQuery('#callphone').val(number);
    var ticketCode = makeUnique(20);
    voiceNotificationLib.dial_make_a_call(number, '', 'outgoing', ticketCode, crm_ticket_id);
  }
  function makeUnique(length) {
    var text = "";
    var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

    for (var i = 0; i < (length + 1); i++)
      text += possible.charAt(Math.floor(Math.random() * possible.length));

    return text;
  }

  function censorPhone(phone, num) {
    var first = (phone.substring(0, num));
    var result = phone.replace(first, "*****");
    return result;
  }
</script>
<script type="text/javascript">

  webcallApi.csrf_name = 'csrf_webcall';
  webcallApi.csrf_hash = '65ae4e5235d728f750fd59e3d47c486a';
  var permission_callout = 'y';

  var auth_user = '11054';
  var auth_pass = 'we5kstlg4xtyqse';
  var ast_host = 'voice.digitel.vn';
  var ast_port = '8089';
  var full_name = 'EL 01';
  var display_val = 'EL 01'
  var phone_type = 'webcall';
  var merchant_id = '5810';
  var merchant_code = 'MjTRs0apb4xiIKFd35hoOC8H7mAYzkynWXwtEgL6';
  var hotline_num = '1666';
  var hotline_prefix = '';
  var extension = '11054';
  var user_id = '10054';
  var show_customer_phone = 'n';
</script>
<style>
  .custom-input {
    background: #FFFABB;
    border: #337ab7 solid 1px;
    width: 98%;
  }
</style>

<div id="notification_call_panel" class="center-content clearfix">
  <div id="customer-output" style="padding: 10px 5px; display: none">
    <div id="receive_income_call_panel" style="font-size: 13px">
      <div class="notice-header">
        <div class="row no-margin">
          <div class="clearfix">
            <div class="pull-left" style="width: 100%; text-align: left">
              <i class="fa fa-sign-in fa-lg"></i><b style="margin-left: 5px;" class="customer-title">GỌI RA</b>
              <i class="fa fa-link customer-link" style="float: right; display: none; cursor: pointer"></i>
            </div>
          </div>

        </div>
      </div>

      <div id="customer-information-panel">
        <div class="notice-info" style="margin-bottom: 0; padding-bottom: 0;text-align: left">
          <div class="clearfix">
            <div class="pull-left">
              <h5 class="blue smaller" style="margin-bottom: 3px;">Thông tin khách hàng</h5>
            </div>
          </div>
          <div class="clearfix">
            <div class="pull-left">
              <i class="fa fa-user ml5" style="opacity: 0.6"></i><span style="margin-left: 5px;"
                class="customer-name"></span>
            </div>
          </div>
          <div class="clearfix">
            <div class="pull-left">
              <i class="fa fa-phone ml5" style="opacity: 0.6"></i><span style="margin-left: 5px;"
                class="customer-phone"></span>
            </div>
          </div>
          <div class="clearfix">
            <div class="pull-left">
              <p style="margin-left: 20px; position: relative; margin-bottom: 0">
                <i class="fa fa-edit" style="opacity: 0.6; left: -14px; position: absolute; top: 4px;"></i>
                <span class="customer-note" style="margin-left: 4px"></span>
              </p>
            </div>
          </div>
        </div>
      </div>


      <div id="tranfer_call_panel"></div>

      <div id="group_btn_call" class="group-btn" style="width: 228px; margin-top: 0; position: absolute; bottom: 36px">
        <a id="btn_answer_call"
          class="btn btn-call btn-sm btn-success width98 m-t-3 btn_income_call btn_income_call_wc btn-round hide"> TRẢ
          LỜI</a>
        <a id="btn_hangup_call"
          class="btn  btn-call btn-danger btn-sm width98 m-t-3 btn_income_call btn_income_call_wc btn-round  "
          onclick="voiceNotificationLib.income_hangup_call()">KẾT THÚC</a>
        <a id="btn_end_call"
          class="btn btn-call btn-danger btn-sm width98 m-t-3 btn_answer_income_call btn_income_call_wc btn-round"
          onclick="voiceNotificationLib.income_end_call()">KẾT THÚC</a>
        <a id="btn_cancel" class="btn  btn-call btn-danger btn-sm width98 m-t-3 btn_income_call_wc btn-round width50 "
          onclick="voiceNotificationLib.dial_make_cancel()">KẾT THÚC</a>
      </div>

      <div id="group_btn_call" class="group-btn" style="width: 230px; position: absolute; bottom: 0">
        <a id="btn_hold_call"
          class="btn btn-call btn-primary btn-sm width50 btn_answer_income_call btn_income_call_wc btn-round disabled "
          onclick="voiceNotificationLib.income_hold_call()">HOLD</a>
        <a id="btn_resume_call" class="btn btn-call btn-sm btn-yellow width50 btn_income_call_wc btn-round hide"
          onclick="voiceNotificationLib.income_unhold_call()">RESUME</a>
        <a id="btn_transfer_call"
          class="btn btn-call btn-primary btn-sm width50 btn_answer_income_call btn_income_call_wc btn-round disabled"
          onclick="voiceNotificationLib.make_transfer_call()">
          TRANS</a>

        <a id="btn_cancel_transfer" class="btn btn-call btn-yellow width50 btn-sm hide btn_income_call_wc btn-round"
          onclick="voiceNotificationLib.go_back_answer_form()">BACK</a>

        <!--        <a id="btn_dtmf"-->
        <!--           class="btn btn-call btn-primary btn-sm width32 btn_answer_income_call btn_income_call_wc btn-round disabled"-->
        <!--           onclick="voiceNotificationLib.on_dtmf()">-->
        <!--            DTMF</a>-->

        <a id="btn_cancel_dtmf" class="btn btn-call btn-yellow width33 btn-sm hide btn_income_call_wc btn-round"
          onclick="voiceNotificationLib.go_back_answer_form()">BACK</a>

      </div>
    </div>

  </div>
  <div id="call-input">
    <input type="hidden" name="notification_call_panel_tc" value="rAdVXnLQZkuNJsGgE92e" />
    <div class="notification_callout_header"></div>
    <div id="keypad">
      <div class="container">
        <div class="row">
          <div class="col-md-4 col-md-offset-4 phone">
            <div class="row1">
              <div class="col-md-12 no-padding">
                <input type="tel" placeholder="0905044xxx" name="name" id="callphone" class="form-control tel" value=""
                  onkeypress="return voiceNotificationLib.enterToCall(event, this.value);" />
                <a id="btn_make_call"
                  onclick="voiceNotificationLib.dial_make_a_call(jQuery('#callphone').val(), '', 'outgoing', '1EGDu9gAxi6R8FaOpTyd');"
                  class="btn btn-success btn-block flatbtn"><i class="fa fa-phone fa-lg"></i></a>
                <div class="num-pad">
                  <div class="span4">
                    <div class="num">
                      <div class="txt">
                        1
                      </div>
                    </div>
                  </div>
                  <div class="span4">
                    <div class="num">
                      <div class="txt">
                        2
                      </div>
                    </div>
                  </div>
                  <div class="span4">
                    <div class="num">
                      <div class="txt">
                        3
                      </div>
                    </div>
                  </div>
                  <div class="span4">
                    <div class="num">
                      <div class="txt">
                        4
                      </div>
                    </div>
                  </div>
                  <div class="span4">
                    <div class="num">
                      <div class="txt">
                        5
                      </div>
                    </div>
                  </div>
                  <div class="span4">
                    <div class="num">
                      <div class="txt">
                        6
                      </div>
                    </div>
                  </div>
                  <div class="span4">
                    <div class="num">
                      <div class="txt">
                        7
                      </div>
                    </div>
                  </div>
                  <div class="span4">
                    <div class="num">
                      <div class="txt">
                        8
                      </div>
                    </div>
                  </div>
                  <div class="span4">
                    <div class="num">
                      <div class="txt">
                        9
                      </div>
                    </div>
                  </div>
                  <div class="span4">
                    <div class="num">
                      <div class="txt">
                        *
                      </div>
                    </div>
                  </div>
                  <div class="span4">
                    <div class="num">
                      <div class="txt">
                        0
                      </div>
                    </div>
                  </div>
                  <div class="span4">
                    <div class="num">
                      <div class="txt">
                        #
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <script type="text/javascript">
        $(document).ready(function () {

          $('.num').click(function () {
            var num = $(this);
            var text = $.trim(num.find('.txt').clone().children().remove().end().text());
            var telNumber = $('#callphone');
            $(telNumber).val(telNumber.val() + text);
          });

        });
      </script>
    </div>
    <div id="siphook_panel" class="dpn">
      <div class="notice-header">
        <div class="row no-margin">
          <div class="clearfix">
            <div class="pull-left"><i class="fa fa-sign-in fa-lg"></i>&nbsp;&nbsp; <b>GỌI VÀO</b></div>
            <div class="pull-right" onclick="webcall.closeIncomePanel(this)"><i
                class="fa fa-close fa-lg csp red"></i>&nbsp;&nbsp;</div>
          </div>
        </div>
      </div>
      <div class="notice-info">
        <div class="clearfix">
          <div class="pull-left">
            <h5 class="blue smaller">Thông tin khách hàng</h5>
          </div>
          <div class="pull-right customer-info-view">
            <a class="csp">
              <i class="fa fa-info-circle fa-lg"></i>
            </a>
          </div>
        </div>
        <div class="clearfix">
          <div class="pull-left mb5">
            <i class="fa fa-user"></i>&nbsp&nbsp&nbsp&nbsp<span class="customer-name"></span>
          </div>
        </div>
        <div class="clearfix">
          <div class="pull-left mb5">
            <i class="fa fa-users"></i> &nbsp<span class="group-name"></span>
          </div>
        </div>
        <div class="clearfix">
          <div class="pull-left">
            <i class="fa fa-phone"></i>&nbsp&nbsp&nbsp<span class="customer-phone"></span>
          </div>
        </div>
      </div>

      <div class="notice-info" id="latest-contact">
        <div class="clearfix">
          <div class="pull-left">
            <h5 class="blue smaller">Liên hệ gần nhất</h5>
          </div>
          <div class="pull-right">
            <a class="csp" onclick="voiceNotificationLib.add_call_note();"><i
                class="fa fa-pencil-square-o fa-lg"></i></a>
          </div>
        </div>

        <div class="clearfix last_note_panel">
          <div class="pull-left">
            <i class="fa fa-clock-o fa-lg"></i>&nbsp&nbsp<span id="last_note_date"></span>
          </div>
        </div>
        <div class="clearfix last_note_panel">
          <div class="pull-left">
            <i class="fa fa-comments-o fa-lg"></i> &nbsp<span id="last_note_data"></span>
          </div>
        </div>

        <div class="clearfix add_call_note_panel hide">
          <form action="https://call.flyfonetalk.com/voice_ajax/call_note" id="call_note_frm" class="form-horizontal"
            method="post" accept-charset="utf-8">
            <input type="hidden" name="act" value="save" style="display:none;" />
            <input type="hidden" name="csrf_webcall" value="65ae4e5235d728f750fd59e3d47c486a" style="display:none;" />
            <input type="hidden" id="ticket_code" name="ticket_code" value="" />
            <input type="hidden" id="call_type" name="call_type" value="" />
            <input type="hidden" id="cus_code" name="cus_code" value="" />


            <div class="form-group mb5">
              <div class="col-xs-12 ">
                <textarea id="call_note" name="call_note" class="form-control" placeholder="Ghi chú"
                  style="height: 75px; width: 227px;"></textarea>
              </div>
            </div>
            <div class="form-group mb5">
              <div class="col-xs-12 ">
                <input type="button" class="btn btn-white btn-info btn-sm" value="Thêm mới"
                  onclick="voiceNotificationLib.save_call_note();">
                <input type="button" class="btn btn-white btn-default btn-sm" value="Hủy"
                  onclick="voiceNotificationLib.cancel_call_note();">
              </div>
            </div>


          </form>
        </div>
      </div>
    </div>
  </div>
</div>